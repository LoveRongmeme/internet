## 一 计算机网络的概述与基本概念
**网络**:由若干节点(node)和连接这些节点的链路组成；主要指电信网络、有线电视网络、计算机网络 =>网络融合<br>
**节点**：计算机、集线器、交换机或者路由器等<br>
计算机网络的最重要的两个功能
* **连通性**：用户间交换信息
* **共享**：资源共享(信息、软件、硬件等)

**互联网**：网络和网络通过路由器互连起来 =>网络的网络<br>
**因特网**：世界上最大的互连网络<br>

因特网发展的三个阶段:
* 从单个网络ARPANET向互联网发展
* 建成了三级结构的因特网
    * 三级结构:主干网、地区网、校园网
* 逐渐形成了多层次**ISP**结构的因特网
    * **ISP(Internet Service Provider)**：因特网服务提供者(中国电信、联通、移动)；ISP从因特网管理机构申请很多IP地址，个人向ISP购买IP地址
因特网交换点**IXP(Internet eXchange Point)**：允许两个网络直接相连(不经过更高级的ISP)

所有的因特网标准都是以**RFC**形式在因特网上发表&nbsp;**RFC(Request For Comment)**：请求评论<br>
制定因特网的正式标准要经过四个阶段:
* **因特网草案** (还不是RFC)
* **建议标准** (从这里开始成为RFC)
* **草案标准**
* **因特网标准** 

**因特网的组成**
* **边缘部分**:所有连接在因特网上的主机(端系统)组成；用户直接使用
* **核心部分**:由大量网络和连接这些网络的路由器组成；为边缘部分提供服务

**计算机之间通信**:主机A的某个进程和主机B的某个进程进行通信<br>
在网络边缘的端系统之间的通信方式一般有两种:**客户-服务器方式(C/S)** 和**对等方式(P2P)**
* **客户-服务器方式(C/S)** :描述的是进程之间的服务与被服务的关系，客户是服务请求方，服务器是服务提供方，客户和服务器都要使用网络核心部分提供的服务；
* **对等方式(P2P)** :(peer-to-peer),两个主机在进行通信时，只要都运行了P2P软件，就可以进行平等地、对等地连接通信，即两个既是客户又是服务器--又被称为P2P文件共享；<br>

**路由器**:(专用计算机，不是主机)，实现**分组交换**的核心构件，任务是转发**分组**<br>
**电路交换**:建立连接(开始占用通信资源)-通话(一直占用通信资源)-释放连接(归还通信资源)的方式；特点:在通话期间，在通话的两个用户始终占用端到端的通信资源<br>
**分组交换**:采用**储存转发**技术;通常把要发送的整块数据称之为**报文**; **分组(packet)** :首部(header,通常包含目的地地址以及源地址等控制信息)+数据=分组；分组是因特网中的传输单元；路由器在接收到一个分组时，先暂时储存，检查其首部信息(目的地地址)后，查找转发表(**协议**)，通过适当接口转发至下一个路由器...直至转发到目的主机;注意，一段报文的各个分组传输不一定是连续的---为每个分组独立地选择转发路由；通信过程中动态分配带宽，对通信链路是逐段占用；可以不建立连接就可以向其他主机发送分组；<br>
**报文交换**:整个报文全部储存下来之后在查找转发表...<br>
**计算机网络的类别**<br>
**计算机网络**的最简单的定义:一些互相连接的、自治的计算机集合。互相连接指可以交换信息；自治指独立的计算机(独自的硬件和软件，可单独运行)<br>
**计算机网络的分类**<br>
**按作用范围分类**:
* **广域网WAN(Wide Area Network)** ：作用范围几十到几千公里
* **城域网MAN(Metropolitan Area Network)** ：作用范围一般是一座城市，5~50公里
* **局域网(Local Area Network)** ：微型计算机或工作站通过高速通信线路相连(速率一般达到10M以上),1公里左右
* **个人区域网(Personal Area Network)** ：个人使用的电子设备用无线技术连接起来的网络，10m左右<br>

**按使用者分类**:
* **公用网**:指电信公司出资建造的大型网络，用户出钱即可使用
* **专用网**:某个部门、行业专门为自己建造的网络<br>

**接入网AN(Access Network)** :是从某个端系统到另一个端系统路径中，由这个端系统到第一个路由器(边缘路由器)之间的物理链路组成；接入网既不属于因特网的边缘部分也不属于因特网的核心部分<br>
**计算机网络性能指标**:
* **速率**:连接在计算机网络上的主机在数字通道上传送数据的速度；也成为数据率或比特率；单位为b/s或bps；**注意**:在计算机领域内，1kb=1024b;在通信领域内，1kb=1000b;以此类推
* **带宽**:原本表示通信线路允许通过的信号频带范围；在计算机网络中，带宽表示网络的通信线路传送数据的能力；定义为单位时间内从网络的某一点到另一点所能通过的最大**数据率**；单位b/s
* **吞吐量**:表示在单位时间内通过某个网络(或信道、接口)的数据量；带宽的数值是该网络的吞吐量上限；单位b/s(Mb/s...)；有时吞吐量还可以用每秒传送的字节数或帧数表示；
* **时延**:表示数据(报文、分组、比特)从网络(链路)的一端传送到另一端的时长；时延=排队时延+处理时延+发送时延+传播时延；
   * **排队时延**:分组在进入路由器后在输入队列中排队以及在路由器确认转发接口后在输出队列中排队所用时长；取决于当时网络的通信量；
   * **处理时延**:主机或者路由器在收到分组后的处理时长；例如分析分组的首部、从分组中提取数据部分、查找适当路由器等；
   * **发送时延**:主机或者路由器发送数据帧所需要的时间；也就是从发送数据帧的第一个比特到该帧的最后一个比特发送完毕所需的时间；发送时延=数据帧长度(b)/发送速率(b/s)---**对于高速网络链路，仅仅只是发送速率比较高，只是减少了发送时延** 
   * **传播时延**:是电磁波在信道传播所需的时间；传播时延=信道长度(m)/电磁波在该信道中的传播速率(m/s)；
* **时延带宽积**:传播时延与带宽的乘积，表示以比特为单位的链路长度，表示从发送端发出的但是还未达到接收端的比特数；
* **往返时间RTT(Round-Trip Time)**: 表示从发送方发送数据开始，到发送发接收到来自接收方的确认所经历的时间；包括各中间环节的各种时延；意义就是表示当发送方连续发送数据时，即使能够及时收到对方的确认，期间已经发送了很多比特了；---在卫星通信是一个应用例子；
* **利用率**:有信道利用率和网络利用率两种；
   * **信道利用率** :指某信道有百分之几的时间是被利用的(有数据通过);完全空闲的信道的利用率为零；并非越高越好---排队理论；以D0表示空闲时的时延，D表示当前网络的时延，U表示利用率，那么在适当的条件下 D=D0/(1-U) ；因此信道利用率太大会产生非常高的时延(一般都不会超过50%，达到50%就要准备扩容)；
   * **网络利用率** :指全网络的信道利用率的加权平均值；
   
**计算机网络非性能特征**:1.费用(包括设计和实现) 2.质量 3.标准化 4.可靠性 5.可扩容性及可升级性 6.易于管理和维护；<br>
**计算机网络体系结构**<br>
过程:解决复杂的计算机网络的复杂协调工作，提出**分层**的思想->**IBM--系统网络体系结构SNA**->**ISO---开放系统互连基本参考模型OSI**->使用最广泛的还是**TCP/IP协议**<br>
**协议与划分层次**:**为进行网络中的数据交换而建立的规则、标准或约定称为网络协议，简称协议**；这些规则明确规定了所交换数据的格式以及有关的同步(广义的，含有时序意味,即在一定条件下应当发生什么事)问题；协议主要由三部分组成:
* 语法:数据与控制信息的结构或格式;
* 语义:需要发送何种控制信息，完成何种动作以及做出何种响应；
* 同步：事件实现顺序的详细说明；

协议的分层好处:1.各层之间是独立的---每一层只需要下层提供的接口；2.灵活性好；3.结构上可分割开---每一层都可以用当前最优的技术来实现；4.易于实现和维护；5.能促进标准化工作；<br>
每一层需要完成的功能(至少实现一种)：
* **差错控制**:使得和网络对等端的相应层次的通信更加可靠；
* **流量控制**:控制发送端的发送速率不要太快，要使得接收端来得及接收；
* **分段和重装**:发送端把要发送的数据分成更小的单元，在接收端还原；
* **复用和分用**:发送端几个高层应用复用同一条低层的连接，在接收端再进行分用；---复用：多个应用层进程可以同时使用下面运输层提供的服务；分用:运输层把收到的信息分别交给上面应用层中的相应进程；
* **连接建立和释放**:交换数据前先建立一条逻辑连接，结束后释放连接；

计算机网络的**体系结构**：计算机网络的各层及协议的集合；精确定义了计算机网络及其构件所应完成的全部功能；体系结构是抽象的，实现是具体的，是真正在运行的计算机硬件或软件；<br>
**具有5层协议的体系结构**
OSI的七层协议体系结构并不实用，TCP/IP四层(应用层，运输层，网际层，网络接口层)结构应用很广，学习的时候把两者结合成5层结构：
* **应用层**:定义的是**应用进程**间通信和交互的规则；任务是通过**应用进程**间的交互来完成特定网络应用；---产生报文段或者用户数据报
* **运输层**:任务是向两个主机的应用进程之间的通信提供**通用的数据传输**服务；应用进程利用该服务传送应用层报文；该层主要使用两种协议:
   * **传输控制协议TCP(Transmission Control Protocol)** ---提供面向连接的、可靠的数据传输服务，数据传输的单位是**报文段**;---TCP三次握手
   * **用户数据报协议UDP(User Datagram Protocol)** ---提供无连接的、尽最大努力(best-effort)的数据传输服务(不保证数据传输的可靠性)，数据传输单位是用户数据报；
* **网络层**:负责为分组交换网上的不同**主机**提供通信服务；网络层把运输层产生的报文段或者用户数据报封装成**分组**或**包**进行传送；网络层的另一个任务就是要选择合适的路由，把运输层传下来的分组通过路由器找到目的主机；因特网的主要协议是无连接的**网际协议IP(Internet Protocol)** 和多种路由选择协议，因此网络层也称作为**网际层**或**IP**层；
* **数据链路层(data link layer)**:简称为**链路层**,在两个相邻节点间传送数据时，链路层将网络层传下来的IP数据报(分组)组装成**帧(framing)**,在两个相邻节点上传送帧；每一帧都包含必要的**控制信息**(如同步信息，地址信息，差错控制等)和数据；
* **物理层(physical layer)** :物理层传输数据单位是比特，一般要考虑接收方如何识别发送方发送的比特；还要确认连接电缆的插头有几根引脚以及各条引脚如何连接等；

注意:现在人们提到的TCP/IP协议指的是因特网所使用的整个**ICP/IP协议族(protocol suite)**<br>
**对等层**:把数据通过水平虚线直接传递给对方(用户认为，实际上不是这样的)，这就是对等层之间的通信；对等层之间传送的数据单元为该层的**协议数据单元PDU(Protocol Datagram Unit)**<br>
**实体**:任何可以发送或接收信息的硬件或软件进程；协议是控制两个对等实体(或多个实体)进行通信的规则的集合；在协议的控制下，两个对等实体间的通信使得本层能够向上层提供服务，要实现本层协议，还需要使用下层提供的服务；---注意协议与服务的区别:协议的实现保证能向上一层提供服务；上面的实体只能看见下面的服务而看不见协议；**协议是水平**的，即是控制对等实体间的通信规则，而**服务是垂直**的，是由下层向上层通过层间接口提供的；
**服务原语**:上层使用下层服务而必须与下层交换的命令；<br>
**服务访问点SAP(Service Access Point)**:同一系统中相邻两层的实体进行交互(交换信息)的地方；其实就是一个逻辑接口；层与层之间交换的数据单位为**服务数据单元SDU(Service Data Unit)**;
## 二 物理层
**物理层**: 考虑的是如何在各种传输媒体上传输数据比特流；<br>
物理层的主要任务描述为确定与传输媒体的接口有关的特性：
* 机械特性:指明接口所有接线器的尺寸与形状、引脚数目和排列等；
* 电气特性: 指明电缆上面各个线路的电压范围；
* 功能特性: 指明某一条线路上的电压代表何种意义；
* 过程特性: 指明对于不同功能的各种可能事件的出现顺序；

数据在计算机中的传输方式大多是**并行传输**；但是数据在通信线路上大多是**串行传输**，即逐个比特按时间顺序传输；因此物理层还需要完成传输方式的转换。<br>**数据通信的基础知识**:<br>
数据通信系统可以分成三个部分:
* **源系统(发送端、发送方)**:从输入信息到输出特定格式的信息
   * **源点(source)**:源点设备产生要传输的数据；例如从pc端输入文字，pc端产生输出的数字比特流；又成为**源站**或者**信源**;
   * **发送器**:将源点产生的数据编码后通过传输系统传输；常见的是调制器；
   * **接收器**:接收传输系统传输过来的数据，并将之转换为目的系统能够识别的数据；常见的解调器；---现在大多数pc都是内置调制解调器；
   * **终点(destination)**:终点设备从接收器获取数字比特流，然后把信息输出(例如，把文字在pc端屏幕上显示出来)；又称为**目的站**或者**信宿**;
* **传输系统(传输网络)**
* **目的系统(接收方、接收端)**

**消息**:话音、文字、视频、图像等都是消息；<br>
**数据**:运送消息的实体；通常是有意义的符号序列；<br>
**信号**:数据的电气或者电磁表现；<br>
根据信号中代表消息的参数取值不同，可以分为两种:
* **模拟信号(连续信号)**:代表消息的参数的取值是连续的；比如调制解调器到终点之间的用户线上传输的就是**模拟信号**；
* **数字信号(离散信号)**:代表消息的参数的取值是离散的；比如源点到调制解调器以及电话网中继线上传输的就是**数字信号**;

**信道(channel)**:表示向某一个方向传送信息的媒体；因此，往往一条通信电路包含一条发送信道和一条接收信道；<br>
从通信双方信息交互的方式可以有三种基本方式:
* **单向通信(单工通信)**:只能有一个方向的通信而没有返回的交互；比如广播
* **双向交替通信(半双工通信)**:通信双方都可以发送信息，但是不可以同时；
* **双向同时通信(全双工通信)**:通信双方可以同时发送和接收信息；

来自**信源**的信号称为**基带信号(基本频带信号)**;**基带信号**往往有很多信道不能够传输的低频成分，因此需要将**基带信号**进行**调制**;<br>
调制分为两大类:
* **基带调制**:仅仅将基带信号的波形进行变换；这种方式只是将数字信号转换成另一种数字信号，因此又称之为**编码(coding)**;
* **带通调制**:通过**载波(carrier)** 将基带信号的频率搬迁到更高的频段，并转换为**模拟信号**;通过载波调制后的信号称为**带通信号**；

常用**编码**方式:
* 不归零制:正电平代表1，负电平代表0；
* 归零制:正脉冲代表1，负脉冲代表0；
* 曼彻斯特编码
* 差分曼彻斯特编码
基本的**带通**调制方法:
* **调幅(AM)**:载波的振幅随基带数字信号的变化而变化
* **调频(FM)**:载波的频率随基带数字信号的变化而变化
* **调相(PM)**:载波的初始相位随基带数字信号的变化而变化

限制**码元**在信道中传输速率有两个因素:
* **信道能够通过的频率范围**:在任何信道中，码元的传输速率有上限，超过上限，则会出现严重的**码间串扰**（在接收端收到的信号波形失去明显界限而模糊），使接收端对码元的识别成为不可能；
* **信噪比**:信号的平均功率与噪声的平均功率之比，常记S/N；以分贝(dB)为单位；即信噪比(dB)=10log10(S/N)(dB);香农公式:
信道的极限传输速率C=Wlog2(1+S/N)(b/s);W位信道的带宽(HZ);

**物理层下面的传输媒体**<br>
**传输媒体**：数据传输系统中发送器和接收器之间的物理通路；可分为两大类:
* **导引型传输媒体**:电磁波被导引沿着固体媒体(铜线或光纤)传播；---有线传输；几种类型:**双绞线**、**同轴电缆**、**光纤**;
* **非导引型传输媒体**:指向自由空间传播；---无线传输

**信道复用技术**<br>
**复用(multiplexing)**:多个信号占同一个信道；通过复用器与分用器成对使用方式，基本的有五种方式:
* **频分复用FDM(Frequency Division Multiplexing)**:不同用户占用不同的信号频带；
* **时分复用**:又称为同步时分复用，将时间分为一段段等长的时分复用帧(**TDM帧**),每一个**TDM帧**又按固定序号分成一个个时间间隙，然后每个间隙由不同用户占用---不同用户在不同时间占用同样的频带宽度；更有利于数字信号的传输；
* **统计时分复用STDM(Statistic TDM)**:又称为异步时分复用，**STDM帧**中的时间间隙按需动态地分配给用户---各用户有数据就随时发往集中器的输入缓存，然后集中器依次扫描输入缓存，然后放到**STDM帧**中没有数据的缓存就跳过，当帧数据满了就发送出去；当然，每个间隙中的信号都必须要有控制信息(目的地址等)**集中器**经常使用这种方式；---**注意**:**TDM帧**和**STDM帧**都是在物理层传输比特流时所划分的帧，与数据链路层中的帧不可混淆；
* **波分复用WDM(Wavelength Division Multiplexing)**:**就是光的频分复用**;由于光载波频率高，所以经常用波长来表示光载波；
* **码分复用CDM(Code Division Multiplexing)**:更常用的是**码分多址CDMA(Code Division Multiple Access)**:各用户使用经过挑选的不同码型，各用户之间使用不会冲突；抗干扰能力强，广泛应用于民用的移动通信中(特别是无线局域网);在**CDMA**中，每一个比特时间被分为m个间隔，称为**码片(chip)**;---数据率提高了m倍，同时占用的频带宽度也提高了m倍；还有个特点，各个用户分配的码片不仅各不相同还要互相**正交**；

**宽带接入技术**<br>
**非对称数字用户线ADSL(Asymmetric Digital Subscriber Line)**:用数字技术对现有的模拟电话用户线进行改造，使它能够承载宽带数字业务。**ADSL**是借助于安装在用户线两端的ADSL调制解调(ATU-C,ATU-R)将原来的数字信号调制成用户线能够通过的频率；---信道为用户独享<br>
**光纤同轴混合网(HFC)**:在有线电视基础上开发的一种居民宽带接入网；HFC把原来的有线电视网的同轴电缆主干部分换成光纤，在光纤节点光信号被转换成电信号。
在**机顶盒**中有为HFC网使用的调制解调器，称为**电缆调制解调器**;---使用共享信道，因此电缆调制解调器比ADSL解调器更复杂(解决冲突问题等)；<br>
为了有效利用光纤资源，在广大用户与光纤干线之间广泛使用**无源光网络PON**,其无需配备电源，长期运营成本以及管理成本都很低。<br>
##数据链路层
数据链路层用的信道有两种：1.点对点通信(ppp协议)2.广播信道(CSMA/CD协议)<br>
**链路**:一个节点到另一个相邻节点之间的物理线路(有线或者无线)；<br>
**数据链路**:把一些通信协议与实现这些协议的硬件和软件(**网络适配器**)加到链路上，就构成了数据链路；<br>
数据链路层的协议有很多，但是都有三个共同点:**封装成帧**、**透明传输**、**差错检测**
* **封装成帧**:在一段数据的前后加上首部和尾部就成了帧；数据是网络层传下来的**IP数据报**(分组)；这样的帧是数据链路层的传送单元；首部和尾部的一个重要作用就是进行**帧定界**;每一种链路层协议都规定了帧的**数据部分长度上限**---**最大传送单元MTU(Maximum Transfer Unit)**;
* **透明传输**:帧的开始和结束的标记使用专门指明的控制字符，当传送的帧是由文本文件组成时，其数据部分不会出现帧定界符，不管什么都能传输，这样的传输叫透明传输；
* **差错检测**:数据在传输过程中可能会出现差错，1可能变成0,0也可能变成1，这样的差错叫**比特差错**，也是传输差错的一种；传输错误的比特占总数的比例叫**误码率**---提高信噪比可以降低误码率；目前数据链路层广泛使用**循环冗余检验CRC(Cyclic Redundancy Check)** 检测技术；如果要在数据链路层实现差错检测，必须要把数据封装成帧，每一帧加上冗余码(FCS),逐帧发送及检错；数据链路层若仅仅使用**CRC**检错技术，则只能实现帧的**无差错接受**---**凡是接收端数据链路层接受的帧均是无差错的**;数据传输还可能出现另一种差错:**帧丢失**|**帧重复**|**帧失序**，**因此使用CRC只能实现无比特差错传输，并不能提供可靠传输**;










